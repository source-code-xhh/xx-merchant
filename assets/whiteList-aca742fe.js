import{G as g,a3 as P,o as L,k as U,m as l,a5 as u,L as a,v as d,l as B,H as T,a6 as $,a7 as D,a8 as I}from"./index-f963a964.js";import{E as A}from"./el-dialog-e37cfe82.js";/* empty css                        */import{E as v,a as _}from"./el-message-c1f6612d.js";import{w as M,d as N,a as F}from"./system-cd3b33e8.js";import{f as S}from"./dateTool-2bd4a934.js";import{a as W,b as j,d as G}from"./index-5f625b61.js";import"./index-46385dca.js";const H={class:"warp"},J={class:"search-tool"},K={class:"search-item"},O={class:"search-item"},Q={class:"add-row"},R={class:"table-box"},X={class:"pager"},Y={class:"edit-row"},Z=l("div",{class:"edit-label"},"用户名：",-1),q={class:"edit-row"},ee=l("div",{class:"edit-label"},"IP：",-1),ae={class:"dialog-footer"},ce={__name:"whiteList",setup(te){const p=g(!1),i=g({}),f=g([]);let h=g(1);const o=g({username:"",page:1,pagenumber:10});P(()=>{r()});const w=()=>{i.value={},p.value=!0},b=s=>{I.confirm(`确定要删除【${s.username}】白名单${s.ip}吗？`).then(async()=>{const e=v.service(),n=await N({id:s.id});e.close(),n.code===200?(_({message:"操作成功！",type:"success"}),r()):_({message:n.msg,type:"error"})}).catch(()=>{})},V=async()=>{const s=v.service();let e;i.value.id||(e=await F(i.value)),s.close(),e.code===200?(_({message:"操作成功！",type:"success"}),r(),p.value=!1):_({message:e.msg,type:"error"})},y=s=>{o.value.pagenumber=s,o.value.page=1,r()},E=s=>{o.value.page=s,r()},C=()=>{o.value.page=1,r()},r=async()=>{const s=v.service(),e=await M(o.value);s.close(),e.code===200?(f.value=e.data.list.map(n=>(n.created_at=n.created_at?S(n.created_at*1e3):"--",n)),h.value=+e.data.count):_({message:e.msg,type:"error"})};return(s,e)=>{const n=$,c=D,m=G,k=W,x=j,z=A;return L(),U(T,null,[l("div",H,[l("div",J,[l("div",K,[u(" 用户名： "),a(n,{class:"search-ipt",modelValue:o.value.username,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.username=t)},null,8,["modelValue"])]),l("div",O,[a(c,{type:"primary",onClick:C},{default:d(()=>[u("搜索")]),_:1})])]),l("div",Q,[a(c,{type:"success",onClick:w},{default:d(()=>[u("新增")]),_:1})]),l("div",R,[a(k,{data:f.value,class:"table",stripe:"","show-overflow-tooltip":"",size:"large"},{default:d(()=>[a(m,{label:"用户名","min-width":"130",prop:"username"}),a(m,{label:"允许登录IP","min-width":"150",prop:"ip"}),a(m,{label:"创建时间","min-width":"150",prop:"created_at"}),a(m,{label:"创建人","min-width":"130",prop:"created_user"}),a(m,{label:"操作","min-width":"100"},{default:d(t=>[a(c,{type:"danger",plain:"",onClick:se=>b(t.row)},{default:d(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l("div",X,[a(x,{"current-page":o.value.page,"onUpdate:currentPage":e[1]||(e[1]=t=>o.value.page=t),"page-size":o.value.pagenumber,"onUpdate:pageSize":e[2]||(e[2]=t=>o.value.pagenumber=t),"page-sizes":[10,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:B(h),onSizeChange:y,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),a(z,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),width:"500px",title:i.value.id?`用户：${i.value.username}`:"添加"},{footer:d(()=>[l("span",ae,[a(c,{onClick:e[5]||(e[5]=t=>p.value=!1)},{default:d(()=>[u("取消")]),_:1}),a(c,{type:"primary",onClick:V},{default:d(()=>[u(" 确定 ")]),_:1})])]),default:d(()=>[l("div",Y,[Z,a(n,{class:"edit-input",modelValue:i.value.username,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.username=t)},null,8,["modelValue"])]),l("div",q,[ee,a(n,{class:"edit-input",placeholder:"'*'号代表允许所有IP登录",modelValue:i.value.ips,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.ips=t)},null,8,["modelValue"])])]),_:1},8,["modelValue","title"])],64)}}};export{ce as default};
